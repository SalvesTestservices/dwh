<%= form_with(url: datalab_report_path(@report), method: :get, data: { controller: 'report', turbo_frame: 'report_data' }) do |form| %>
  <div class="bg-gray-50 shadow-sm ring-1 ring-gray-900/5 sm:rounded-lg p-4 mb-4 border border-gray-100">
    <div class="flex flex-row justify-between w-full p-2">
      <div class="flex flex-row gap-4 justify-start">
        <% anchor_service.filterable_attributes.each do |attr| %>
          <div class="px-4">
            <%= form.label "filters[#{attr}]", @anchor_service.available_attributes[attr][:name], 
                class: "block text-sm font-bold underline underline-offset-2 text-gray-700" %>
            <div class="mt-1">
              <%= form.select "filters[#{attr}][]",
                  options_for_select(filter_options_for_attribute(attr), params.dig(:filters, attr)),
                  {},
                  { multiple: true,
                    class: "block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 focus:ring-2 focus:ring-inset focus:ring-blue-600 sm:text-sm sm:leading-6",
                    data: { action: "change->report#submit" } } %>
            </div>
          </div>
        <% end %>
      </div>
      <div class="text-2xl font-bold pt-7"><%= @records.count %></div>
    </div>
  </div>
<% end %>
